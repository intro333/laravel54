{"version":3,"sources":["Cart.js"],"names":[],"mappings":"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","file":"Cart-compiled.js","sourcesContent":["import React, {Component} from 'react';\nimport {connect} from 'react-redux';\nimport Select from 'react-select';\nimport '../../theme/css/index.css';\nimport '../../theme/css/main.css';\nimport '../../theme/css/adaptive.css';\nimport {Link} from 'react-router-dom';\nimport Navigation from '../Navigation/Navigation';\nimport MenuMobile from '../Popups/MenuMobile';\nimport CartItem from '../Cart/CartItem';\nimport * as modelActions from '../../actions';\nimport {\n  showProductsInCart,\n  showOrdersQuotaInCart,\n  sendOrder,\n  checkTimeQuota,\n} from '../../api';\nimport {isEmptyMap} from '../../helpers';\n\nclass Cart extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      comment: '',\n      time_quota: 0,\n      cart_error: '',\n    };\n\n  }\n\n  componentWillMount() {\n    const { dispatch } = this.props;\n    showProductsInCart(dispatch);\n    showOrdersQuotaInCart(dispatch);\n  }\n\n  handleChangeComment(event) {\n    this.setState({comment: event.target.value});\n  }\n\n  handleChangeTimeQuota(e) {\n    const { dispatch } = this.props;\n    dispatch(modelActions.setErrors(''));\n    this.setState({\n      cart_error: ''\n    });\n    this.setState({time_quota: e.value});\n  }\n\n  handlerSendOrder() {\n    const { dispatch, history, ordersQuota } = this.props;\n    const data = {\n      comment: this.state.comment,\n      time_quota: this.state.time_quota\n    };\n    if (this.state.time_quota !== 0) {\n      sendOrder(dispatch, data, history);\n    } else if (ordersQuota.ordersQuota && ordersQuota.ordersQuota.length === 0) {\n      sendOrder(dispatch, data, history)\n    } else {\n      this.setState({\n        cart_error: 'Выберите удобный период получения заказа.'\n      });\n    }\n  }\n\n  render() {\n    const { ordersQuota, productsForCart, errorMessageCountQuota } = this.props;\n    // checkTimeQuota(dispatch, {time_quota: this.state.time_quota}); //TODO чекаем кол-во квот\n    // const check = api.get('checkTimeQuota');                       //TODO чекаем кол-во квот\n    var total = null;\n\n    const productsTd = isEmptyMap(productsForCart) && productsForCart.map((item) =>\n      <CartItem\n        keyProductId={item.productId}\n        key={item.productId}\n        item={item}\n      />\n    );\n\n    total = productsForCart.reduce((total, item) => {\n        return total + ((item.count === '' ? 1 : parseInt(item.count, 10)) * parseInt(item.price, 10));\n      }, 0\n    );\n\n    var timeQuotaOptions = [{value: 0, label: ''}];\n    var delivery = null;\n    ordersQuota.ordersQuota && ordersQuota.ordersQuota.length !== 0 && ordersQuota.ordersQuota.forEach(q => q.orders_quota_id !== 1 &&\n      timeQuotaOptions.push({value: q.orders_quota_id, label: q.time_quota}));\n\n    const quotaStyle = {\n      width: '100%',\n      display: 'flex',\n      alignItems: 'center'\n    }\n\n    var ordersQoutaDiv = <div style={quotaStyle}>\n      <label className=\"order-filds-label\" htmlFor=\"time_quota\">Я смогу забрать свой заказ в период с</label>\n      <div style={{width: '120px', marginLeft: '10px'}}>\n        <Select\n          name=\"time_quota\"\n          value={this.state.time_quota}\n          options={timeQuotaOptions}\n          onChange={this.handleChangeTimeQuota.bind(this)}\n          placeholder=''\n          clearable={false}\n          searchable={false}\n        />\n      </div>\n    </div>;\n\n    var OrderNonQuota = <label className=\"order-filds-label\" htmlFor=\"time_quota\" style={{marginBottom: '15px'}}>\n      Заказ можно получить в любое удобное время в указанный день доставки.Периоды получения заказа закончились.\n    </label>;\n    return (\n      <div className=\"container\">\n        <Navigation />\n        <MenuMobile />\n        <div className=\"main-container\">\n          <div className=\"flex-box-between\">\n            <h3>Корзина</h3>\n            <div onClick={this.handlerSendOrder.bind(this)} className=\"cart-button\">Отправить заказ</div>\n          </div>\n\n          <table className=\"cart-products-table\">\n            <thead>\n              <tr className=\"cart-tr-head\">\n                <th className=\"table-30-procent\">Продукт</th>\n                <th className=\"table-25-procent\">Цена</th>\n                <th className=\"table-25-procent\">Количество</th>\n                <th className=\"table-10-procent\">Стоимость</th>\n                <th className=\"table-10-procent\"></th>\n              </tr>\n            </thead>\n            <tbody>\n              { productsTd }\n            </tbody>\n          </table>\n          <div className=\"cart-order__total\">Сумма:&nbsp;<span>{ total } ₽</span></div>\n          <textarea\n            name=\"comment\"\n            className=\"cart-comment\"\n            value={this.state.comment}\n            onChange={this.handleChangeComment.bind(this)}\n            placeholder=\"Оставьте комментарий к заказу...\"\n          />\n          <label className=\"order-filds-label\">Дата доставки {ordersQuota.delivery ? ordersQuota.delivery.delivery_date : ''}</label>\n          {ordersQuota.ordersQuota && ordersQuota.ordersQuota.length !== 0 ? ordersQoutaDiv : OrderNonQuota}\n          <label className=\"order-filds-label\" style={{color: 'red', fontSize: '12px', marginTop: '5px'}}>\n            {\n              this.state.cart_error !== '' ? this.state.cart_error : errorMessageCountQuota\n            }\n            </label>\n          <div onClick={this.handlerSendOrder.bind(this)} className=\"cart-button\">Отправить заказ</div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default connect(store => ({\n  dispatch: store.dispatch,\n  session: store.session,\n  api: store.api,\n  ordersQuota: store.api.get('ordersQuota'),\n  productsForCart: store.api.get('productsForCart'),\n  errorMessageCountQuota: store.session.get('errors').errorTime,\n}))(Cart);"]}