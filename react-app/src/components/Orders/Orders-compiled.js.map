{"version":3,"sources":["Orders.js"],"names":[],"mappings":"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","file":"Orders-compiled.js","sourcesContent":["import React, {Component} from 'react';\nimport {connect} from 'react-redux';\nimport Select from 'react-select';\nimport * as helpers from '../../helpers';\nimport '../../theme/css/index.css';\nimport '../../theme/css/main.css';\nimport '../../theme/css/adaptive.css';\nimport Navigation from '../Navigation/Navigation';\nimport MenuMobile from '../Popups/MenuMobile';\nimport OrderItem from '../Orders/OrderItem';\nimport {\n  ordersGetAll,\n  showOrdersQuotaInCart\n} from '../../api';\nimport * as modelActions from '../../actions';\nimport Footer from '../Navigation/Footer';\n\nclass Orders extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      orderStatus: 1,\n      orderYear: new Date().getUTCFullYear(),\n      orderMonth: (new Date().getUTCMonth() + 1)\n    }\n  }\n\n  ordersGetAll(status, year, month) {\n    const { dispatch } = this.props;\n    const data = {\n      status: status,\n      year: year,\n      month: month,\n    };\n    dispatch(modelActions.setLoaderStatus(true));\n    ordersGetAll(dispatch, data);\n  }\n\n  componentWillMount() {\n    const { dispatch } = this.props;\n    showOrdersQuotaInCart(dispatch);\n    this.ordersGetAll(this.state.orderStatus, this.state.orderYear, this.state.orderMonth);\n  }\n\n  componentWillReceiveProps(props) {\n    const { dispatch, api } = props || this.props;\n    if(props.api.get('componentWillReceivePropsChange')) {\n      this.ordersGetAll(this.state.orderStatus, this.state.orderYear, this.state.orderMonth);\n      dispatch(modelActions.componentWillReceivePropsChange(false));\n    }\n  }\n\n  handleChangeOrderStatus(e) {\n    this.setState({orderStatus: e.value});\n    this.ordersGetAll(e.value, this.state.orderYear, this.state.orderMonth);\n  }\n\n  handlerChangeOrderMonth(e) {\n    this.setState({orderMonth: e.value});\n    this.ordersGetAll(this.state.orderStatus, this.state.orderYear, e.value);\n  }\n\n  handlerChangeOrderYear(e) {\n    this.setState({orderYear: e.value});\n    this.ordersGetAll(this.state.orderStatus, e.value, this.state.orderMonth);\n  }\n\n  render() {\n\n    const { api, history, ordersQuota } = this.props;\n    const orders = api.get('orders');\n    var tables = null;\n    const orderControlStatus = ordersQuota && ordersQuota.delivery && ordersQuota.delivery.order_control_status;\n\n    if(helpers.isEmptyMap(orders)) {\n      tables = Object.entries(orders).map((item, index) =>\n          <OrderItem\n            orderId={item[1][0]['orderId']}\n            emailHash={item[1][0]['emailHash']}\n            orderDate={item[1][0]['orderDate']}\n            timeQuota={item[1][0]['timeQuota']}\n            timeQuotaId={item[1][0]['timeQuotaId']}\n            key={item[1][0]['orderId']}\n            item={item[1]}\n            history={history}\n            stateOrderStatus={this.state.orderStatus}\n            orderStatus={orderControlStatus && orderControlStatus}\n            ordersQuota={ordersQuota}\n          />\n      );\n    }\n\n    const OrderStatusOptions = [\n      { value: 1, label: 'Обрабатывается' },\n      { value: 2, label: 'Выполнен' },\n      { value: 3, label: 'Удален/Отменен' },\n      // { value: 3, label: 'Отправлен' }\n    ];\n\n    const yearOptions = helpers.getNumberSelectOptions(2012, (new Date().getUTCFullYear()), false);\n    const monthOptions = [\n      { value: 1, label: 'Январь' }, { value: 2, label: 'Февраль' }, { value: 3, label: 'Март' }, { value: 4, label: 'Апрель' }, { value: 5, label: 'Май' }, { value: 6, label: 'Июнь' }, { value: 7, label: 'Июль' }, { value: 8, label: 'Август' }, { value: 9, label: 'Сентябрь' }, { value: 10, label: 'Октябрь' }, { value: 11, label: 'Ноябрь' }, { value: 12, label: 'Декабрь' }\n    ];\n\n    if((this.state.orderStatus === 1 || this.state.orderStatus === 5) && tables && tables.length === 0) {\n      tables = <p style={{fontSize: '16px'}}><b>У вас нет обрабатываемых заказов.</b></p>;\n    } else if(this.state.orderStatus === 2 && tables && tables.length === 0) {\n      tables = <p style={{fontSize: '16px'}}>\n        Заказов со статусом <b>Выполнен</b> за <span style={{color: '#4CAF50', fontWeight: 'bold'}}>{monthOptions[this.state.orderMonth - 1].label} {this.state.orderYear}</span> не найдено.\n      </p>\n    } else if(this.state.orderStatus === 3 && tables && tables.length === 0) {\n      tables = <p style={{fontSize: '16px'}}>\n        Заказов со статусом <b>Удален</b> за <span style={{color: '#4CAF50', fontWeight: 'bold'}}>{monthOptions[this.state.orderMonth - 1].label} {this.state.orderYear}</span> не найдено.\n      </p>\n    }\n\n    return (\n      <div>\n        <div className=\"container\">\n          <Navigation />\n          <MenuMobile />\n          <div className=\"main-container\">\n            <div className=\"category-head\">\n              <h3 className=\"bread-crumbs-on-page\">Мои заказы</h3>\n            </div>\n            {orderControlStatus && orderControlStatus === 5 &&\n            <p className=\"personal-explain-text\" style={{color: 'red'}}>Заказ передан на исполнение.</p>}\n            <div className=\"order-filter-main\">\n              <div className=\"order-filds-label-input\">\n                <label className=\"order-filds-label\" htmlFor=\"status\">Статус заказа</label>\n                <Select\n                  name=\"status\"\n                  value={this.state.orderStatus}\n                  options={OrderStatusOptions}\n                  onChange={this.handleChangeOrderStatus.bind(this)}\n                  clearable={false}\n                  searchable={false}\n                />\n              </div>\n              <div className=\"order-filds-label-input\">\n                <label className=\"order-filds-label\" htmlFor=\"status\">Месяц</label>\n                <Select\n                  className=\"margin-right-10\"\n                  name=\"birthdate\"\n                  value={this.state.orderMonth}\n                  options={monthOptions}\n                  onChange={this.handlerChangeOrderMonth.bind(this)}\n                  placeholder=\"\"\n                  clearable={false}\n                  searchable={false}\n                  scrollMenuIntoView={false}\n                />\n              </div>\n              <div className=\"order-filds-label-input\">\n                <label className=\"order-filds-label\" htmlFor=\"status\">Год</label>\n                <Select\n                  name=\"birthdate\"\n                  value={this.state.orderYear}\n                  options={yearOptions}\n                  onChange={this.handlerChangeOrderYear.bind(this)}\n                  clearable={false}\n                  searchable={false}\n                  scrollMenuIntoView={false}\n                />\n              </div>\n            </div>\n            <div className=\"orders-all\">\n                {tables}\n            </div>\n          </div>\n        </div>\n        <Footer />\n      </div>\n    );\n  }\n}\n\nexport default connect(store => ({\n  dispatch: store.dispatch,\n  session: store.session,\n  api: store.api,\n  ordersQuota: store.api.get('ordersQuota'),\n}))(Orders);"]}