{"version":3,"sources":["OrderItem.js"],"names":[],"mappings":"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","file":"OrderItem-compiled.js","sourcesContent":["import React, {Component} from 'react';\nimport { connect } from 'react-redux';\nimport classNames from 'classnames';\nimport '../../theme/css/main.css';\nimport '../../theme/css/adaptive.css';\nimport {\n  cancelOrDeleteOrder,\n  repeatOrChangeOrder,\n} from '../../api';\nimport * as modelActions from '../../actions';\n\nclass OrderItem extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      orderNum: false,\n      tdBotyVisible: false,\n      textHeader: '',\n      function: null,\n      textAlign: false\n    };\n  }\n\n  componentWillMount() {\n\n  }\n\n  handleClickOrder() {\n    var orderNum = this.state.orderNum;\n    var isVisible = this.state.tdBotyVisible;\n\n    this.setState({\n      orderNum: !orderNum,\n      tdBotyVisible: !isVisible\n    })\n  }\n\n  handlerCancelOrder(e) {\n    const { dispatch } = this.props;\n    var text = e.target.innerText;\n    dispatch(modelActions.setOpenCloseModal({\n      show: true,\n      textHeader: 'Вы уверены, что хотите ' + text.toLowerCase() + '?',\n      textAlign: true,\n      function: () => {\n        const { dispatch, history } = this.props;\n        const data = {\n          orderId: this.props.orderId,\n          orderRemove: false,\n        };\n        dispatch(modelActions.setLoaderStatus(true));\n        cancelOrDeleteOrder(dispatch, data, history);\n      }\n    }));\n  }\n\n  handlerDeleteOrder() {\n    const { dispatch, history } = this.props;\n    const data = {\n      orderId: this.props.orderId,\n      orderRemove: true,\n    };\n    dispatch(modelActions.setLoaderStatus(true));\n    cancelOrDeleteOrder(dispatch, data, history);\n  }\n\n  handlerRepeatOrder() {\n    const { dispatch } = this.props;\n    dispatch(modelActions.setOpenCloseModal({\n      show: true,\n      textHeader: 'Если в корзине есть товары, то они будут удалены. Продолжить?',\n      textAlign: false,\n      function: () => {\n        const { dispatch, history } = this.props;\n        const data = {\n          orderId: this.props.orderId,\n          orderChange: false\n        };\n        dispatch(modelActions.setLoaderStatus(true));\n        repeatOrChangeOrder(dispatch, data, history);\n      }\n    }));\n  }\n\n  handlerChangeOrder() {\n    const { dispatch } = this.props;\n    dispatch(modelActions.setOpenCloseModal({\n      show: true,\n      textHeader: 'Вы будете перемещены в корзину, где сможете отредактировать свой заказ повторно. Продолжить?',\n      textAlign: false,\n      function: () => {\n        const { dispatch, history } = this.props;\n        const data = {\n          orderId: this.props.orderId,\n          orderChange: true\n        };\n        dispatch(modelActions.setLoaderStatus(true));\n        repeatOrChangeOrder(dispatch, data, history);\n      }\n    }));\n  }\n\n  handlerSuccessModal() {\n    this.state.function();\n  }\n\n  render() {\n    const { ordersQuota } = this.props;\n    var items = this.props.item;\n\n    const orderNumberInp = classNames({\n      'order-number-inp': true,\n    });\n    const totalStyle = {\n      margin: '10px'\n    };\n\n    var productsTr = items.map((item, index) => {\n        if(index !== 0) {\n          return <tr key={index}>\n            <td className=\"table-40-procent-td\">\n              <img className=\"cart-product-image\" src={'/storage/images/products/' + item.image_path}/>\n              <span>{item.name}</span>\n            </td>\n            <td>{item.price} Р / {item.unit}</td>\n            <td style={{textAlign: 'start'}}>\n              <div className=\"order-table__cell\">\n                <div className=\"b-number\">\n                  <div className=\"order-number\" style={{width: '70px', border: '2px solid #f9f9f9'}}>\n                    <div className=\"order-number__field\">\n                      <input\n                        disabled\n                        className={orderNumberInp}\n                        type=\"number\"\n                        max=\"99\"\n                        min=\"0\"\n                        value={item.counts}\n                      />\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </td>\n            <td>{item.cost} Р</td>\n            <td style={{color: 'firebrick'}}>\n            <span\n              className=\"remove-product\"\n            >\n            </span>\n            </td>\n          </tr>\n        }\n      }\n    );\n\n    var headTd = null;\n\n    if (!this.state.orderNum) {\n      headTd = <tr className=\"order-tr-head\" onClick={this.handleClickOrder.bind(this)}>\n        <th className=\"order-th-head\">Заказ № ST-{this.props.emailHash}-{this.props.orderId} от {this.props.orderDate}</th>\n        <th className=\"table-25-procent\"></th>\n        <th className=\"table-25-procent\"></th>\n        <th className=\"table-10-procent\"></th>\n        <th className=\"table-10-procent\"></th>\n      </tr>\n    } else {\n      headTd = <tr className=\"order-tr-head tr_opened\" onClick={this.handleClickOrder.bind(this)}>\n        <th className=\"table-30-procent\">Продукт</th>\n        <th className=\"table-25-procent\">Цена</th>\n        <th className=\"table-25-procent\">Количество</th>\n        <th className=\"table-10-procent\">Стоимость</th>\n        <th className=\"table-10-procent\"></th>\n      </tr>\n    }\n\n    var itemsForTotal = items.filter((number, index) => index !== 0);\n    var total = itemsForTotal.reduce((total, item) => total + item.cost, 0);\n    var orderConfigCancel = '';\n\n\n    switch (this.props.stateOrderStatus) {\n      case 1:  // Если заказ обрабатывается\n        if (this.props.orderStatus !== 5) {\n          orderConfigCancel = <span onClick={this.handlerCancelOrder.bind(this)}>Отменить заказ</span>;\n        } else {\n            orderConfigCancel = <span></span>;\n          }\n        break;\n\n      case 2:  // Если заказ выполнен\n        orderConfigCancel = <span onClick={this.handlerCancelOrder.bind(this)}>Удалить</span>;\n        break;\n\n      case 3:  // Если заказ удален\n        orderConfigCancel = <span onClick={this.handlerDeleteOrder.bind(this)}>Удалить</span>;\n        break;\n    }\n\n    var orderInfo =\n      <div className=\"order-instruments\">\n        <div className=\"order-info\">\n          <span>Заказ № ST-{this.props.emailHash}-{this.props.orderId} от {this.props.orderDate}</span>\n          <span>Дата доставки {ordersQuota.delivery && ordersQuota.delivery.delivery_date}</span>\n          {\n            this.props.timeQuota !== '' ?\n            <span>Период получения заказа {this.props.timeQuota}</span> :\n              <span>Заказ можно получить в любое удобное время в указанный день доставки.</span>\n          }\n        </div>\n        <div className=\"order-config\">\n          {(this.props.stateOrderStatus !== 1 && this.props.orderStatus !== 5 && this.props.orderStatus !== 2) && <span onClick={this.handlerRepeatOrder.bind(this)}>Повторить заказ</span>}\n          {(this.props.stateOrderStatus === 1 && this.props.orderStatus !== 5 && this.props.orderStatus !== 2) && <span onClick={this.handlerChangeOrder.bind(this)}>Изменить заказ</span>}\n          {this.props.orderStatus === 5 && <span></span>}\n          {orderConfigCancel}\n        </div>\n      </div>;\n\n    return (\n      <div className=\"orders-item\">\n        { this.state.tdBotyVisible &&  orderInfo }\n        <table className=\"cart-products-table cart-products-table__order margin-off animation-page-load-medium\">\n          <thead>\n            { headTd }\n          </thead>\n          <tbody>\n            { this.state.tdBotyVisible && productsTr }\n          </tbody>\n        </table>\n        {\n          this.state.tdBotyVisible &&\n          <div className=\"cart-order__total order_total\" style={totalStyle}>Сумма:&nbsp;<span>{ total } Р</span></div>\n        }\n      </div>\n    );\n  }\n}\n\nexport default connect(store => ({\n  dispatch: store.dispatch,\n  session: store.session,\n  api: store.api,\n  products: store.products,\n}))(OrderItem);"]}