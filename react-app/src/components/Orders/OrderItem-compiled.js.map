{"version":3,"sources":["OrderItem.js"],"names":[],"mappings":"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","file":"OrderItem-compiled.js","sourcesContent":["import React, {Component} from 'react';\nimport { Link } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport classNames from 'classnames';\nimport '../../theme/css/bootstrap-datepicker3.min.css';\nimport '../../theme/css/main.css';\nimport '../../theme/css/adaptive.css';\nimport Modal  from '../Popups/Modal';\nimport {\n  showOrdersQuotaInCart,\n  cancelOrDeleteOrder,\n  repeatOrChangeOrder,\n} from '../../api';\n// import * as modelActions from './actions';\n\nclass OrderItem extends Component {\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      orderNum: false,\n      tdBotyVisible: false,\n      fadeIn: false,\n      modalDisplay: false,\n      textHeader: '',\n      function: null\n    };\n  }\n\n  componentWillMount() {\n    const { dispatch } = this.props;\n    showOrdersQuotaInCart(dispatch);\n  }\n\n  handleClickOrder() {\n    var orderNum = this.state.orderNum;\n    var isVisible = this.state.tdBotyVisible;\n\n    this.setState({\n      orderNum: !orderNum,\n      tdBotyVisible: !isVisible\n    })\n  }\n\n  handlerCancelOrder(e) {\n    var text = e.target.innerText;\n    this.setState({\n      fadeIn: true,\n      modalDisplay: true,\n      textHeader: 'Вы уверены, что хотите ' + text.toLowerCase() + '?',\n      function: () => {\n        const { dispatch, history } = this.props;\n        const data = {\n          orderId: this.props.orderId,\n          orderRemove: false,\n        };\n        cancelOrDeleteOrder(dispatch, data, history)\n      }\n    });\n  }\n\n  handlerDeleteOrder() {\n    const { dispatch, history } = this.props;\n    const data = {\n      orderId: this.props.orderId,\n      orderRemove: true,\n    };\n    cancelOrDeleteOrder(dispatch, data, history)\n  }\n\n  handlerRepeatOrder() {\n    this.setState({\n      fadeIn: true,\n      modalDisplay: true,\n      textHeader: 'Если в корзине есть товары, то они будут удалены. Продолжить?',\n      function: () => {\n        const { dispatch, history } = this.props;\n        const data = {\n          orderId: this.props.orderId,\n          orderChange: false\n        };\n        repeatOrChangeOrder(dispatch, data, history)\n      }\n    });\n  }\n\n  handlerChangeOrder() {\n    this.setState({\n      fadeIn: true,\n      modalDisplay: true,\n      textHeader: 'Вы будете перемещены в корзину, где сможете отредактировать свой заказ повторно. Продолжить?',\n      function: () => {\n        const { dispatch, history } = this.props;\n        const data = {\n          orderId: this.props.orderId,\n          orderChange: true\n        };\n        repeatOrChangeOrder(dispatch, data, history)\n      }\n    });\n  }\n\n  handlerCloseModal() {\n    this.setState({\n      fadeIn: false,\n      modalDisplay: false,\n    });\n  }\n\n  handlerSuccessModal() {\n    this.state.function();\n  }\n\n  render() {\n    const { ordersQuota } = this.props;\n    var items = this.props.item;\n\n    const orderNumberInp = classNames({\n      'order-number-inp': true,\n    });\n    const totalStyle = {\n      margin: '10px'\n    };\n\n    var productsTr = items.map((item, index) => {\n        if(index !== 0) {\n          return <tr key={index}>\n            <td className=\"table-40-procent-td\">\n              <img className=\"cart-product-image\" src={'/storage/images/products/' + item.image_path}/>\n              <span>{item.name}</span>\n            </td>\n            <td>{item.price} ₽ / {item.unit}</td>\n            <td style={{textAlign: 'start'}}>\n              <div className=\"order-table__cell\">\n                <div className=\"b-number\">\n                  <div className=\"order-number\" style={{width: '70px', border: '2px solid #f9f9f9'}}>\n                    <div className=\"order-number__field\">\n                      <input\n                        disabled\n                        className={orderNumberInp}\n                        type=\"number\"\n                        max=\"99\"\n                        min=\"0\"\n                        value={item.counts}\n                      />\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </td>\n            <td>{item.cost} ₽</td>\n            <td style={{color: 'firebrick'}}>\n            <span\n              className=\"remove-product\"\n              aria-hidden=\"true\"\n            >\n            </span>\n            </td>\n          </tr>\n        }\n      }\n    );\n\n    var headTd = null;\n\n    if (!this.state.orderNum) {\n      headTd = <tr className=\"order-tr-head\" onClick={this.handleClickOrder.bind(this)}>\n        <th className=\"order-th-head\">Заказ № ST-{this.props.emailHash}-{this.props.orderId} от {this.props.orderDate}</th>\n        <th className=\"table-25-procent\"></th>\n        <th className=\"table-25-procent\"></th>\n        <th className=\"table-10-procent\"></th>\n        <th className=\"table-10-procent\"></th>\n      </tr>\n    } else {\n      headTd = <tr className=\"order-tr-head tr_opened\" onClick={this.handleClickOrder.bind(this)}>\n        <th className=\"table-30-procent\">Продукт</th>\n        <th className=\"table-25-procent\">Цена</th>\n        <th className=\"table-25-procent\">Количество</th>\n        <th className=\"table-10-procent\">Стоимость</th>\n        <th className=\"table-10-procent\"></th>\n      </tr>\n    }\n\n    var itemsForTotal = items.filter((number, index) => index !== 0);\n    var total = itemsForTotal.reduce((total, item) => total + item.cost, 0);\n    var orderConfigCancel = '';\n\n      switch(this.props.orderStatus) {\n        case 1:  // Если заказ обрабатывается\n          orderConfigCancel = <span onClick={this.handlerCancelOrder.bind(this)}>Отменить заказ</span>\n          break;\n        case 2:  // Если заказ выполнен\n          orderConfigCancel = <span onClick={this.handlerCancelOrder.bind(this)}>Удалить</span>\n          break;\n        case 3:  // Если заказ удален\n          orderConfigCancel = <span onClick={this.handlerDeleteOrder.bind(this)}>Удалить</span>\n          break;\n      }\n\n    var orderInfo =\n      <div className=\"order-instruments\">\n        <div className=\"order-info\">\n          <span>Заказ № ST-{this.props.emailHash}-{this.props.orderId} от {this.props.orderDate}</span>\n          <span>Дата доставки {ordersQuota.delivery && ordersQuota.delivery.delivery_date}</span>\n          {\n            this.props.timeQuota !== '' ?\n            <span>Период получения заказа {this.props.timeQuota}</span> :\n              <span>Заказ можно получить в любое удобное время в указанный день доставки.</span>\n          }\n        </div>\n        <div className=\"order-config\">\n          {/*{this.props.orderStatus === 1 && <span>Редактировать заказ</span>}*/}\n          {this.props.orderStatus !== 1 && <span onClick={this.handlerRepeatOrder.bind(this)}>Повторить заказ</span>}\n          {this.props.orderStatus === 1 && <span onClick={this.handlerChangeOrder.bind(this)}>Изменить заказ</span>}\n          {orderConfigCancel}\n        </div>\n      </div>;\n\n    return (\n      <div className=\"orders-item\">\n        <Modal\n          fadeIn={this.state.fadeIn}\n          modalDisplay={this.state.modalDisplay}\n          handlerCloseModal={this.handlerCloseModal.bind(this)}\n          handlerSuccessModal={this.handlerSuccessModal.bind(this)}\n          textHeader={this.state.textHeader}\n          textBody={this.state.textBody}\n        />\n        { this.state.tdBotyVisible &&  orderInfo }\n        <table className=\"cart-products-table margin-off animation-page-load-medium\">\n          <thead>\n            { headTd }\n          </thead>\n          <tbody>\n            { this.state.tdBotyVisible && productsTr }\n          </tbody>\n        </table>\n        {\n          this.state.tdBotyVisible &&\n          <div className=\"cart-order__total\" style={totalStyle}>Сумма:&nbsp;<span>{ total } ₽</span></div>\n        }\n      </div>\n    );\n  }\n}\n\nexport default connect(store => ({\n  dispatch: store.dispatch,\n  session: store.session,\n  api: store.api,\n  ordersQuota: store.api.get('ordersQuota'),\n  products: store.products,\n}))(OrderItem);"]}